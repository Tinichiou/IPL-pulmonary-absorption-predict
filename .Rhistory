theme(plot.title = element_text(size=20,hjust = 0.5))+
coord_cartesian(xlim = c(-2, 0), ylim = c(-2,0.5))+
xlab("logka - observed")+ylab("logka - predicted")+
geom_segment(aes(x = -1.75, xend = 0, y = -1.75, yend =0)
,colour="darkgray")
x11()
p3 + guides(color = "none")+geom_text(hjust=-0.15,vjust=0.8,
size=4,color="black")
p3 <- ggplot(df_p, aes(x=logka, y=MTL_predict_logka,
color="cyan4",label=chemical)) +
geom_point(size=3)+
ggtitle("MTL model")+
theme_bw(base_size = 15)+
theme(plot.title = element_text(size=20,hjust = 0.5))+
coord_cartesian(xlim = c(-2, 0), ylim = c(-2,0.5))+
xlab("logka - observed")+ylab("logka - predicted")+
geom_segment(aes(x = -1.75, xend = 0, y = -1.75, yend =0)
,colour="darkgray")
x11()
p3 + guides(color = "none")+geom_text(hjust=-0.15,vjust=0.8,
size=4,color="black")
col_label2 <- c(rep("cyan4",6))
col_label2
p3 <- ggplot(df_p, aes(x=logka, y=MTL_predict_logka,
color=col_label2,label=chemical)) +
geom_point(size=3)+
ggtitle("MTL model")+
theme_bw(base_size = 15)+
theme(plot.title = element_text(size=20,hjust = 0.5))+
coord_cartesian(xlim = c(-2, 0), ylim = c(-2,0.5))+
xlab("logka - observed")+ylab("logka - predicted")+
geom_segment(aes(x = -1.75, xend = 0, y = -1.75, yend =0)
,colour="darkgray")
x11()
p3 + guides(color = "none")+geom_text(hjust=-0.15,vjust=0.8,
size=4,color="black")
remove(p2)
p3 <- ggplot(df_p, aes(x=logka, y=MTL_predict_logka,
color=col_label2,label=chemical)) +
geom_point(size=3)+
ggtitle("MTL model")+
theme_bw(base_size = 15)+
theme(plot.title = element_text(size=20,hjust = 0.5))+
coord_cartesian(xlim = c(-2, 0), ylim = c(-2,0.5))+
xlab("logka - observed")+ylab("logka - predicted")+
geom_segment(aes(x = -1.75, xend = 0, y = -1.75, yend =0)
,colour="darkgray")
x11()
p3 + guides(color = "none")+geom_text(hjust=-0.15,vjust=0.8,
size=4,color="black")
df_p = read.csv("C:\\Users\\Tini\\Desktop\\QSAR\\yuwen MTL\\實驗最終程式碼\\comparison test.csv")
x <- df_p$logka
y <- df_p$DS_PLS_predict_logka
col_label <- c(rep("darkorange1",2),rep("cyan4",4))
col_label2 <- c(rep("cyan4",6))
library(ggplot2)
# Basic scatter plot
p2 <- ggplot(df_p, aes(x=logka, y=DS_PLS_predict_logka,
color=col_label,label=chemical)) +
geom_point(size=3)+
ggtitle("PLS model")+
theme_bw(base_size = 15)+
theme(plot.title = element_text(size=20,hjust = 0.5))+
coord_cartesian(xlim = c(-2, 0), ylim = c(-2,0.5))+
xlab("logka - observed")+ylab("logka - predicted")+
geom_segment(aes(x = -1.75, xend = 0, y = -1.75, yend =0)
,colour="darkgray")
x11()
p2 + guides(color = "none")+geom_text(hjust=1.1,vjust=1,
size=4,color="black")
p3 <- ggplot(df_p, aes(x=logka, y=MTL_predict_logka,
color=col_label2,label=chemical)) +
geom_point(size=3)+
ggtitle("MTL model")+
theme_bw(base_size = 15)+
theme(plot.title = element_text(size=20,hjust = 0.5))+
coord_cartesian(xlim = c(-2, 0), ylim = c(-2,0.5))+
xlab("logka - observed")+ylab("logka - predicted")+
geom_segment(aes(x = -1.75, xend = 0, y = -1.75, yend =0)
,colour="darkgray")
x11()
p3 + guides(color = "none")+geom_text(hjust=-0.15,vjust=0.8,
size=4,color="black")
p3 <- ggplot(df_p, aes(x=logka, y=MTL_predict_logka,
color="blue",label=chemical)) +
geom_point(size=3)+
ggtitle("MTL model")+
theme_bw(base_size = 15)+
theme(plot.title = element_text(size=20,hjust = 0.5))+
coord_cartesian(xlim = c(-2, 0), ylim = c(-2,0.5))+
xlab("logka - observed")+ylab("logka - predicted")+
geom_segment(aes(x = -1.75, xend = 0, y = -1.75, yend =0)
,colour="darkgray")
p3 + guides(color = "none")+geom_text(hjust=-0.15,vjust=0.8,
size=4,color="black")
p2 + guides(color = "none")+geom_text(hjust=1.1,vjust=1,
size=4,color="black")
x11()
p3 + guides(color = "none")+geom_text(hjust=-0.15,vjust=0.8,
size=4,color="black")
p2 <- ggplot(df_p, aes(x=logka, y=DS_PLS_predict_logka,
label=chemical)) +
geom_point(size=3)+
ggtitle("PLS model")+
theme_bw(base_size = 15)+
theme(plot.title = element_text(size=20,hjust = 0.5))+
coord_cartesian(xlim = c(-2, 0), ylim = c(-2,0.5))+
xlab("logka - observed")+ylab("logka - predicted")+
geom_segment(aes(x = -1.75, xend = 0, y = -1.75, yend =0)
,colour="darkgray")
x11()
p2 + guides(color = "none")+geom_text(hjust=1.1,vjust=1,
size=4,color="black")
p3 <- ggplot(df_p, aes(x=logka, y=MTL_predict_logka,
color="blue",label=chemical)) +
geom_point(size=3)+
ggtitle("MTL model")+
theme_bw(base_size = 15)+
theme(plot.title = element_text(size=20,hjust = 0.5))+
coord_cartesian(xlim = c(-2, 0), ylim = c(-2,0.5))+
xlab("logka - observed")+ylab("logka - predicted")+
geom_segment(aes(x = -1.75, xend = 0, y = -1.75, yend =0)
,colour="darkgray")
x11()
p3 + guides(color = "none")+geom_text(hjust=-0.15,vjust=0.8,
size=4,color="black")
p3 <- ggplot(df_p, aes(x=logka, y=MTL_predict_logka,
label=chemical)) +
geom_point(size=3)+
ggtitle("MTL model")+
theme_bw(base_size = 15)+
theme(plot.title = element_text(size=20,hjust = 0.5))+
coord_cartesian(xlim = c(-2, 0), ylim = c(-2,0.5))+
xlab("logka - observed")+ylab("logka - predicted")+
geom_segment(aes(x = -1.75, xend = 0, y = -1.75, yend =0)
,colour="darkgray")
x11()
p3 + guides(color = "none")+geom_text(hjust=-0.15,vjust=0.8,
size=4,color="black")
col_label2 <- c(rep("cyan4",6))
p3 <- ggplot(df_p, aes(x=logka, y=MTL_predict_logka,
label=chemical)) +
geom_point(aes(size=3, color=col_label2))+
ggtitle("MTL model")+
theme_bw(base_size = 15)+
theme(plot.title = element_text(size=20,hjust = 0.5))+
coord_cartesian(xlim = c(-2, 0), ylim = c(-2,0.5))+
xlab("logka - observed")+ylab("logka - predicted")+
geom_segment(aes(x = -1.75, xend = 0, y = -1.75, yend =0)
,colour="darkgray")
x11()
p3 + guides(color = "none")+geom_text(hjust=-0.15,vjust=0.8,
size=4,color="black")
col_label2
df_p = read.csv("C:\\Users\\Tini\\Desktop\\QSAR\\yuwen MTL\\實驗最終程式碼\\comparison test.csv")
x <- df_p$logka
y <- df_p$DS_PLS_predict_logka
col_label <- c(rep("darkorange1",2),rep("cyan4",4))
col_label2 <- c(rep("cyan4",6))
library(ggplot2)
df_p = read.csv("C:\\Users\\Tini\\Desktop\\QSAR\\yuwen MTL\\實驗最終程式碼\\comparison test.csv")
x <- df_p$logka
y <- df_p$DS_PLS_predict_logka
col_label <- c(rep("darkorange1",2),rep("cyan4",4))
col_label2 <- c(rep("cyan4",6))
library(ggplot2)
p3 <- ggplot(df_p, aes(x=logka, y=MTL_predict_logka,
color=col_label2,label=chemical)) +
geom_point(size=3)+
ggtitle("MTL model")+
theme_bw(base_size = 15)+
theme(plot.title = element_text(size=20,hjust = 0.5))+
coord_cartesian(xlim = c(-2, 0), ylim = c(-2,0.5))+
xlab("logka - observed")+ylab("logka - predicted")+
geom_segment(aes(x = -1.75, xend = 0, y = -1.75, yend =0)
,colour="darkgray")
x11()
p3 + guides(color = "none")+geom_text(hjust=-0.15,vjust=0.8,
size=4,color="black")
df_p = read.csv("C:\\Users\\Tini\\Desktop\\QSAR\\yuwen MTL\\實驗最終程式碼\\comparison test.csv")
x <- df_p$logka
y <- df_p$DS_PLS_predict_logka
col_label2 <- c(rep("cyan4",6))
library(ggplot2)
p3 <- ggplot(df_p, aes(x=logka, y=MTL_predict_logka,
color=col_label2,label=chemical)) +
geom_point(size=3)+
ggtitle("MTL model")+
theme_bw(base_size = 15)+
theme(plot.title = element_text(size=20,hjust = 0.5))+
coord_cartesian(xlim = c(-2, 0), ylim = c(-2,0.5))+
xlab("logka - observed")+ylab("logka - predicted")+
geom_segment(aes(x = -1.75, xend = 0, y = -1.75, yend =0)
,colour="darkgray")
x11()
p3 + guides(color = "none")+geom_text(hjust=-0.15,vjust=0.8,
size=4,color="black")
col_label <- c(rep("cyan4",4),rep("darkorange1",2))
p2 <- ggplot(df_p, aes(x=logka, y=DS_PLS_predict_logka,
color=col_label,label=chemical)) +
geom_point(size=3)+
ggtitle("PLS model")+
theme_bw(base_size = 15)+
theme(plot.title = element_text(size=20,hjust = 0.5))+
coord_cartesian(xlim = c(-2, 0), ylim = c(-2,0.5))+
xlab("logka - observed")+ylab("logka - predicted")+
geom_segment(aes(x = -1.75, xend = 0, y = -1.75, yend =0)
,colour="darkgray")
x11()
p2 + guides(color = "none")+geom_text(hjust=1.1,vjust=1,
size=4,color="black")
col_label <- c(rep("cyan4",2),rep("darkorange1",4))
p2 <- ggplot(df_p, aes(x=logka, y=DS_PLS_predict_logka,
color=col_label,label=chemical)) +
geom_point(size=3)+
ggtitle("PLS model")+
theme_bw(base_size = 15)+
theme(plot.title = element_text(size=20,hjust = 0.5))+
coord_cartesian(xlim = c(-2, 0), ylim = c(-2,0.5))+
xlab("logka - observed")+ylab("logka - predicted")+
geom_segment(aes(x = -1.75, xend = 0, y = -1.75, yend =0)
,colour="darkgray")
x11()
p2 + guides(color = "none")+geom_text(hjust=1.1,vjust=1,
size=4,color="black")
plot(x,y,main="PLS model",
xlab= "logka-observed",
ylab= "logka-predicted",
col= col_label, pch = 19, cex = 1, lty = "solid", lwd = 2,
xlim = c(-2,0),ylim=c(-2,0.5))
x=c(1,1)
y=c(1,2)
plot(x,y,main="PLS model",
xlab= "logka-observed",
ylab= "logka-predicted",
col= c("darkorange1","cyan4"), pch = 19, cex = 1, lty = "solid", lwd = 2,
xlim = c(-2,0),ylim=c(-2,0.5))
x=c(1,1)
y=c(1,2)
plot(x,y,main="PLS model",
xlab= "logka-observed",
ylab= "logka-predicted",
col= c("darkorange1","cyan4"), pch = 19, cex = 1, lty = "solid", lwd = 2,
)
plot(x,y,main="PLS model",
xlab= "logka-observed",
ylab= "logka-predicted",
col= c("darkorange1","cyan4"), pch = 19, cex = 1)
?plot
plot(x,y,main="PLS model",
xlab= "logka-observed",
ylab= "logka-predicted",
pch = 19, cex = 1)
x=c(1,1)
y=c(1,2)
plot(x,y,main="PLS model",
xlab= "logka-observed",
ylab= "logka-predicted",
pch = 19, cex = 1)
plot(x,y)
plot(x,y)
require(datasets)
plot(x=airquality$Ozone,
y=airquality$Wind,
main="Ozone to Wind",
xlab="Ozone(ppb)",
ylab="Wind(mph)",
pch=16                  # 點的圖形
)
airquality$Ozone
plot(x=airquality$Ozone,
y=airquality$Wind,
main="Ozone to Wind",
xlab="Ozone(ppb)",
ylab="Wind(mph)",
pch=16                  # 點的圖形
)
x=c(1,1)
y=c(1,2)
plot(x,y,main="PLS model",
xlab= "logka-observed",
ylab= "logka-predicted",
pch = 19, cex = 1)
plot(x,y)
plot(x,y,main="PLS model",
xlab= "logka-observed",
ylab= "logka-predicted",
color=c("darkorange1","cyan4")
pch = 19, cex = 1)
plot(x,y,main="PLS model",
xlab= "logka-observed",
ylab= "logka-predicted",
color=c("darkorange1","cyan4"),
pch = 19, cex = 1)
plot(x,y,main="PLS model",
xlab= "logka-observed",
ylab= "logka-predicted",
col=c("darkorange1","cyan4"),
pch = 19, cex = 1)
?plot
plot(x,y,main="PLS model",
xlab= "logka-observed",
ylab= "logka-predicted",
col=c("darkorange1","cyan4"),
pch = 19, cex = 1,
ylim=c(0,5))
plot(x,y,main="PLS model",
xlab= "logka-observed",
ylab= "logka-predicted",
col=c("darkorange1","cyan4"),
pch = 19, cex = 1,
ylim=c(0,7))
x11()
plot(x,y,main="PLS model",
xlab= "logka-observed",
ylab= "logka-predicted",
col=c("darkorange1","cyan4"),
pch = 19, cex = 1,
ylim=c(0,7))
color_df = data.frame(x)
View(color_df)
color_df$y = y
View(color_df)
ggplot(color_df, aes(x=x, y=y,
color=c("darkorange1","cyan4"))) +
geom_point(size=3)
library(ggplot2)
ggplot(color_df, aes(x=x, y=y,
color=c("darkorange1","cyan4"))) +
geom_point(size=3)
ggplot(color_df, aes(x=x, y=y,
color=c("darkorange1","cyan4"))) +
geom_point(size=3)
p4 <- ggplot(color_df, aes(x=x, y=y,
color=c("darkorange1","cyan4"))) +
geom_point(size=3)
p4
x11()
p4
p4 <- ggplot(color_df, aes(x=x, y=y,
color=c("darkorange1","cyan4"))) +
geom_point(size=3)+theme_classci()+
coord_cartesian(ylim = c(0,7))+
x11()
p4
p4 <- ggplot(color_df, aes(x=x, y=y,
color=c("darkorange1","cyan4"))) +
geom_point(size=3)+theme_classic()+
coord_cartesian(ylim = c(0,7))+
x11()
p4
p4 <- ggplot(color_df, aes(x=x, y=y,
color=c("darkorange1","cyan4"))) +
geom_point(size=3)+theme_classic()+
coord_cartesian(ylim = c(0,20))+
x11()
p4
p4 <- ggplot(color_df, aes(x=x, y=y,
color=c("darkorange1","cyan4"))) +
geom_point(size=3)+theme_classic()+
coord_cartesian(ylim = c(0,19))+
x11()
p4
p4 <- ggplot(color_df, aes(x=x, y=y,
color=c("darkorange1","cyan4"))) +
geom_point(size=3)+theme_classic()+
coord_cartesian(ylim = c(0,15))+
x11()
p4
df_p = read.csv("C:\\Users\\Tini\\Desktop\\QSAR\\yuwen MTL\\實驗最終程式碼\\comparison test.csv")
x <- df_p$logka
y <- df_p$DS_PLS_predict_logka
col_label <- c(rep("cyan4",2),rep("darkorange1",4))
col_label2 <- c(rep("cyan4",6))
library(ggplot2)
# Basic scatter plot
p2 <- ggplot(df_p, aes(x=logka, y=DS_PLS_predict_logka,
color=col_label,label=chemical)) +
geom_point(size=3)+
ggtitle("PLS model")+
theme_bw(base_size = 15)+
theme(plot.title = element_text(size=20,hjust = 0.5))+
coord_cartesian(xlim = c(-2, 0), ylim = c(-2,0.5))+
xlab("logka - observed")+ylab("logka - predicted")+
geom_segment(aes(x = -1.75, xend = 0, y = -1.75, yend =0)
,colour="darkgray")
x11()
p2 + guides(color = "none")+geom_text(hjust=1.1,vjust=1,
size=4,color="black")
p3 <- ggplot(df_p, aes(x=logka, y=MTL_predict_logka,
color=col_label2,label=chemical)) +
geom_point(size=3)+
ggtitle("MTL model")+
theme_bw(base_size = 15)+
theme(plot.title = element_text(size=20,hjust = 0.5))+
coord_cartesian(xlim = c(-2, 0), ylim = c(-2,0.5))+
xlab("logka - observed")+ylab("logka - predicted")+
geom_segment(aes(x = -1.75, xend = 0, y = -1.75, yend =0)
,colour="darkgray")
x11()
p3 + guides(color = "none")+geom_text(hjust=-0.15,vjust=0.8,
size=4,color="black")
a <- c(1,1,1)
b <- c(2,2,2)
a+b
print(a+b)
load("mtmodel.Rdata")
load("feature_minmax.Rdata")
#要改相對路徑
setwd("C:\\Users\\Tini\\Documents\\專案程式\\IPL_app")
load("mtmodel.Rdata")
load("feature_minmax.Rdata")
#要改相對路徑
setwd("C:\\Users\\Tini\\Documents\\專案程式\\IPL_app")
load("mtmodel.Rdata")
load("feature_minmax.Rdata")
library(extraTrees)
inputdata <- read.csv('descriptors_padelpy_test.csv',fileEncoding = "UTF-8-BOM")
len <- nrow(inputdata)
y.nhat = predict(et, inputdata[,feature], newtasks=rep(1,len))
inputdata[,feature]
View(et)
inputdata[,feature]
rep(1,len)
predict(et, inputdata[,feature], newtasks=rep(1,len))
memory.limit()
memory.limit(size=25000)
options(java.parameters = "-Xmx8000m")
setwd("C:\\Users\\Tini\\Desktop\\QSAR\\testfolder")
Data <- read.csv('after_delete_high_cor.csv')
Data <- Data[-1052,]
Data <- Data[-12,]
library(mlbench)
library(caret)
missingvalue <- sapply(Data, function(x) sum(is.na(x)))
missing.index <- as.numeric(which(missingvalue!=0))
missing.index <- sort(missing.index)
infvalue <- sapply(Data, function(x) sum(is.infinite(x)))
inf.index <- as.numeric(which(infvalue!=0))
Data <- Data[,-c(inf.index,missing.index)]
rm(inf.index,infvalue,missing.index,missingvalue)
#
Data$y <- Data$log10_mean_ka
Data$y.n <- rep(NA, length(Data$y))
IPLy <- as.vector(Data[which(Data$task==1),"y"])
caco2y <- as.vector(Data[which(Data$task==2),"y"])
calu3y <- as.vector(Data[which(Data$task==3),"y"])
min1 <- min(IPLy)
min2 <- min(caco2y)
min3 <- min(calu3y)
max1 <- max(IPLy)
max2 <- max(caco2y)
max3 <- max(calu3y)
Data$y.n[which(Data$task==1)] <- (IPLy-min1)/(max1-min1)
Data$y.n[which(Data$task==2)] <- (caco2y-min2)/(max2-min2)
Data$y.n[which(Data$task==3)] <- (calu3y-min3)/(max3-min3)
IPL <- Data[which(Data$task==1),]
caco2 <- Data[which(Data$task==2),]
calu3 <- Data[which(Data$task==3),]
feature <- c("SHBd","CrippenLogP","nAcid","MDEO.11","TopoPSA","nBase","ATSC1e")
set.seed(0)
et = extraTrees(Data[,feature], Data$y.n,
tasks=Data$task,numThreads = 5)
#要改相對路徑
setwd("C:\\Users\\Tini\\Documents\\專案程式\\IPL_app")
inputdata <- read.csv('descriptors_padelpy_test.csv',fileEncoding = "UTF-8-BOM")
len <- nrow(inputdata)
y.nhat = predict(et, inputdata[,feature], newtasks=rep(1,len))
View(et)
#要改相對路徑
setwd("C:\\Users\\Tini\\Documents\\專案程式\\IPL_app")
load("mtmodel.Rdata")
View(et)
setwd("C:\\Users\\Tini\\Desktop\\QSAR\\testfolder")
et = extraTrees(Data[,feature], Data$y.n,
tasks=Data$task,numThreads = 5)
View(et)
#要改相對路徑
setwd("C:\\Users\\Tini\\Documents\\專案程式\\IPL_app")
save(et, file = "mtmodel.Rdata")
load("mtmodel.Rdata")
View(et)
getwd()
View(et)
set.seed(0)
et = extraTrees(Data[,feature], Data$y.n,
tasks=Data$task,numThreads = 5)
View(et)
saveRDS(et, file = "mtmodel.rds")
mtmodel <- readRDS("mtmodel.rds")
View(mtmodel)
View(et)
prepareForSave(et)
saveRDS(et, file = "mtmodel.rds")
mtmodel <- readRDS("mtmodel.rds")
View(mtmodel)
getwd()
?write.table
inputdata[,feature]
inputdata <- read.csv('descriptors_padelpy_test.csv',fileEncoding = "UTF-8-BOM")
inputdata <- inputdata[,c("Name",feature)]
inputdata[,feature]
View(inputdata)
outdata <- read.csv('output_tmp.csv',fileEncoding = "UTF-8-BOM")
View(outdata)
View(outdata)
View(outdata)
outdata[3,2] <- "W"
outdata[3,2] <- "NA"
outdata <- read.csv('output_tmp.csv',fileEncoding = "UTF-8-BOM")
outdata <- read.csv('output_tmp.csv',fileEncoding = "UTF-8-BOM")
outdata <- read.csv('output_tmp.csv',fileEncoding = "UTF-8-BOM")
